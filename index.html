<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Podar Learn School Niphad - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2332;
            --accent-primary: #00d4aa;
            --accent-secondary: #ff6b35;
            --accent-tertiary: #3b82f6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #2d3748;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .font-display {
            font-family: 'Space Grotesk', sans-serif;
        }

        /* Fixed Background */
        .bg-fixed {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(ellipse at 15% 15%, rgba(0, 212, 170, 0.07) 0%, transparent 45%),
                radial-gradient(ellipse at 85% 85%, rgba(255, 107, 53, 0.05) 0%, transparent 45%),
                radial-gradient(ellipse at 50% 50%, rgba(59, 130, 246, 0.03) 0%, transparent 60%),
                var(--bg-primary);
        }

        /* Sidebar - Fixed Position */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            z-index: 100;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }

        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            padding: 12px 0;
        }

        .sidebar-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            flex-shrink: 0;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            margin: 2px 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.25s ease;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .sidebar-item:hover {
            background: rgba(0, 212, 170, 0.1);
            color: var(--accent-primary);
        }

        .sidebar-item.active {
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(0, 212, 170, 0.05));
            color: var(--accent-primary);
            border: 1px solid rgba(0, 212, 170, 0.25);
        }

        .sidebar-item svg {
            flex-shrink: 0;
        }

        /* Main Content - Proper Margin */
        .main-wrapper {
            margin-left: 260px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .main-content {
            padding: 24px;
            flex: 1;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(0, 212, 170, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        /* Stat Cards Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            position: relative;
        }

        .stat-card .stat-icon {
            position: absolute;
            right: 16px;
            bottom: 16px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            opacity: 0.1;
        }

        .stat-card .stat-value {
            font-size: 28px;
            font-weight: 700;
            line-height: 1.2;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 24px;
        }

        .quick-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.25s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .quick-btn:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 170, 0.15);
        }

        .quick-btn .icon-wrap {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }

        @media (max-width: 1024px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-box {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
        }

        .chart-box canvas {
            max-height: 280px;
        }

        /* Bottom Section */
        .bottom-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 24px;
        }

        @media (max-width: 1024px) {
            .bottom-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Table Styles */
        .table-wrapper {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            text-align: left;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.2);
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .data-table td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        .data-table tbody tr:hover {
            background: rgba(0, 212, 170, 0.03);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s ease;
            border: none;
            font-family: 'Outfit', sans-serif;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4aa, #00b894);
            color: #0a0f1a;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 170, 0.35);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid #ff6b35;
            color: #ff6b35;
        }

        .btn-secondary:hover {
            background: #ff6b35;
            color: #0a0f1a;
        }

        .btn-ghost {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-ghost:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-primary);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        /* Form Inputs */
        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            font-size: 14px;
            transition: all 0.25s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.15);
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 13px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(4px);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 24px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        /* Payment Methods */
        .payment-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            margin-bottom: 10px;
            transition: all 0.2s ease;
        }

        .payment-item:hover {
            background: rgba(0, 212, 170, 0.05);
        }

        .payment-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Activity Timeline */
        .activity-item {
            display: flex;
            gap: 14px;
            padding: 14px 0;
            border-bottom: 1px solid var(--border);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-primary);
            margin-top: 5px;
            flex-shrink: 0;
            box-shadow: 0 0 10px var(--accent-primary);
        }

        /* Status Badges */
        .badge {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.15);
            color: #ef4444;
        }

        .badge-purple {
            background: rgba(168, 85, 247, 0.15);
            color: #a855f7;
        }

        .badge-blue {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }

        .badge-orange {
            background: rgba(249, 115, 22, 0.15);
            color: #f97316;
        }

        .badge-cyan {
            background: rgba(6, 182, 212, 0.15);
            color: #06b6d4;
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease;
        }

        /* Page Content */
        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 14px 20px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            z-index: 300;
            animation: notifIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @keyframes notifIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Print Styles */
        @media print {
            body * { visibility: hidden; }
            .print-area, .print-area * { visibility: visible; }
            .print-area { position: absolute; left: 0; top: 0; width: 100%; }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .main-wrapper {
                margin-left: 0;
            }
        }

        /* Mobile Menu Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 16px;
            left: 16px;
            z-index: 150;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            cursor: pointer;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 1024px) {
            .mobile-toggle {
                display: flex;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-primary);
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Fixed Background -->
    <div class="bg-fixed"></div>

    <!-- Mobile Toggle -->
    <button class="mobile-toggle" onclick="toggleSidebar()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"/>
            <line x1="3" y1="6" x2="21" y2="6"/>
            <line x1="3" y1="18" x2="21" y2="18"/>
        </svg>
    </button>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 44px; height: 44px; border-radius: 12px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center;">
                    <span class="font-display" style="font-weight: 700; font-size: 18px; color: #0a0f1a;">P</span>
                </div>
                <div>
                    <h2 class="font-display" style="font-size: 15px; font-weight: 700;">Podar Learn School</h2>
                    <p style="font-size: 12px; color: var(--text-muted);">Niphad</p>
                </div>
            </div>
        </div>

        <nav class="sidebar-nav">
            <div class="sidebar-item active" data-page="dashboard" onclick="switchPage('dashboard')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                </svg>
                <span>Dashboard</span>
            </div>
            <div class="sidebar-item" data-page="students" onclick="switchPage('students')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                <span>Students</span>
            </div>
            <div class="sidebar-item" data-page="fees" onclick="switchPage('fees')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="1" x2="12" y2="23"/>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
                <span>Fee Collection</span>
            </div>
            <div class="sidebar-item" data-page="reports" onclick="switchPage('reports')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
                <span>Reports</span>
            </div>
            <div class="sidebar-item" data-page="qr" onclick="switchPage('qr')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"/>
                    <rect x="14" y="3" width="7" height="7"/>
                    <rect x="3" y="14" width="7" height="7"/>
                    <rect x="14" y="14" width="7" height="7"/>
                </svg>
                <span>QR Lookup</span>
            </div>
            <div class="sidebar-item" data-page="ai" onclick="switchPage('ai')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2"/>
                    <circle cx="8" cy="14" r="2"/>
                    <circle cx="16" cy="14" r="2"/>
                </svg>
                <span>AI Assistant</span>
            </div>
            <div class="sidebar-item" data-page="settings" onclick="switchPage('settings')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                </svg>
                <span>Settings</span>
            </div>
        </nav>

        <div class="sidebar-footer">
            <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #ff6b35, #f97316); display: flex; align-items: center; justify-content: center;">
                    <span style="font-weight: 600; font-size: 14px;">AC</span>
                </div>
                <div style="flex: 1; min-width: 0;">
                    <p style="font-weight: 600; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Accountant</p>
                    <p style="font-size: 11px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">accountant@podar.edu.in</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Wrapper -->
    <div class="main-wrapper">
        <!-- Header -->
        <header class="main-header">
            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 16px;">
                <div>
                    <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 4px;" id="currentDate">Wed, 25 Feb, 2026</p>
                    <h1 class="font-display" style="font-size: 24px; font-weight: 700;">
                        <span id="greeting">Good Morning</span>, Accountant!
                    </h1>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="openModal('newAdmission')">New Admission</button>
                    <button class="btn btn-secondary" onclick="openModal('collectFee')">Collect Fee</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="page-dashboard" class="page-content active">
                <!-- School Banner -->
                <div class="card" style="margin-bottom: 24px; background: linear-gradient(135deg, rgba(0, 212, 170, 0.08), rgba(59, 130, 246, 0.08));">
                    <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                        <div style="width: 56px; height: 56px; border-radius: 14px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center;">
                            <span class="font-display" style="font-size: 22px; font-weight: 700; color: #0a0f1a;">P</span>
                        </div>
                        <div>
                            <h2 class="font-display" style="font-size: 18px; font-weight: 700;">Podar Learn School Niphad</h2>
                            <p style="font-size: 13px; color: var(--text-muted);">Academic Year 2026-27</p>
                        </div>
                        <div style="margin-left: auto;">
                            <span class="badge badge-success">All Systems Active</span>
                        </div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="card stat-card">
                        <div class="stat-icon" style="background: #00d4aa;"></div>
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 8px;">Total Students</p>
                        <p class="stat-value font-display" id="statStudents">4,817</p>
                        <p style="font-size: 12px; color: #00d4aa; margin-top: 6px;">All Active</p>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon" style="background: #10b981;"></div>
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 8px;">Fees Collected</p>
                        <p class="stat-value font-display" style="font-size: 24px;" id="statCollected">₹11,05,61,750</p>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top: 8px;">
                            <div class="progress-bar" style="flex: 1;">
                                <div class="progress-fill" style="width: 48.1%; background: #10b981;"></div>
                            </div>
                            <span style="font-size: 12px; color: #10b981; font-weight: 600;">48.1%</span>
                        </div>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon" style="background: #f59e0b;"></div>
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 8px;">Pending Fees</p>
                        <p class="stat-value font-display" style="font-size: 24px;" id="statPending">₹11,92,78,250</p>
                        <p style="font-size: 12px; color: #f59e0b; margin-top: 6px;">3,106 Defaulters</p>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon" style="background: #3b82f6;"></div>
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 8px;">Today's Collection</p>
                        <p class="stat-value font-display" style="color: #3b82f6;" id="statToday">₹5,94,000</p>
                        <p style="font-size: 12px; color: var(--text-muted); margin-top: 6px;">32 Receipts Today</p>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div style="margin-bottom: 24px;">
                    <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">Quick Actions</h3>
                    <div class="quick-actions">
                        <button class="quick-btn" onclick="openModal('newAdmission')">
                            <div class="icon-wrap" style="background: linear-gradient(135deg, #00d4aa, #00b894);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="8.5" cy="7" r="4"/>
                                    <line x1="20" y1="8" x2="20" y2="14"/>
                                    <line x1="23" y1="11" x2="17" y2="11"/>
                                </svg>
                            </div>
                            <span>New Student</span>
                        </button>
                        <button class="quick-btn" onclick="openModal('collectFee')">
                            <div class="icon-wrap" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                    <line x1="12" y1="1" x2="12" y2="23"/>
                                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                                </svg>
                            </div>
                            <span>Collect Fee</span>
                        </button>
                        <button class="quick-btn" onclick="switchPage('reports')">
                            <div class="icon-wrap" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                </svg>
                            </div>
                            <span>View Reports</span>
                        </button>
                        <button class="quick-btn" onclick="switchPage('qr')">
                            <div class="icon-wrap" style="background: linear-gradient(135deg, #a855f7, #9333ea);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                    <rect x="3" y="3" width="7" height="7"/>
                                    <rect x="14" y="3" width="7" height="7"/>
                                    <rect x="3" y="14" width="7" height="7"/>
                                    <rect x="14" y="14" width="7" height="7"/>
                                </svg>
                            </div>
                            <span>Scan QR</span>
                        </button>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="chart-box">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Monthly Collection</h3>
                        <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">Fee collection per month</p>
                        <canvas id="monthlyChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Students by Class</h3>
                        <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">Total: 4,817 students</p>
                        <canvas id="classChart"></canvas>
                    </div>
                </div>

                <!-- Bottom Section -->
                <div class="bottom-grid">
                    <!-- Payment Methods -->
                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Payment Methods</h3>
                        <div class="payment-item">
                            <div class="payment-icon" style="background: rgba(168, 85, 247, 0.15);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#a855f7" stroke-width="2">
                                    <rect x="5" y="2" width="14" height="20" rx="2"/>
                                    <line x1="12" y1="18" x2="12.01" y2="18"/>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <p style="font-weight: 600; font-size: 14px;">UPI</p>
                                <p style="font-size: 12px; color: var(--text-muted);">2,847 payments</p>
                            </div>
                            <span style="font-weight: 600; color: #00d4aa;">49%</span>
                        </div>
                        <div class="payment-item">
                            <div class="payment-icon" style="background: rgba(16, 185, 129, 0.15);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                                    <rect x="2" y="6" width="20" height="12" rx="2"/>
                                    <circle cx="12" cy="12" r="2"/>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <p style="font-weight: 600; font-size: 14px;">Cash</p>
                                <p style="font-size: 12px; color: var(--text-muted);">1,523 payments</p>
                            </div>
                            <span style="font-weight: 600; color: #00d4aa;">26%</span>
                        </div>
                        <div class="payment-item">
                            <div class="payment-icon" style="background: rgba(59, 130, 246, 0.15);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
                                    <rect x="1" y="4" width="22" height="16" rx="2"/>
                                    <line x1="1" y1="10" x2="23" y2="10"/>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <p style="font-weight: 600; font-size: 14px;">Card</p>
                                <p style="font-size: 12px; color: var(--text-muted);">876 payments</p>
                            </div>
                            <span style="font-weight: 600; color: #00d4aa;">15%</span>
                        </div>
                        <div class="payment-item">
                            <div class="payment-icon" style="background: rgba(249, 115, 22, 0.15);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <p style="font-weight: 600; font-size: 14px;">Cheque</p>
                                <p style="font-size: 12px; color: var(--text-muted);">362 payments</p>
                            </div>
                            <span style="font-weight: 600; color: #00d4aa;">6%</span>
                        </div>
                        <div class="payment-item">
                            <div class="payment-icon" style="background: rgba(6, 182, 212, 0.15);">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#06b6d4" stroke-width="2">
                                    <path d="M3 21h18"/>
                                    <path d="M3 10h18"/>
                                    <path d="M5 6l7-3 7 3"/>
                                    <path d="M4 10v11"/>
                                    <path d="M20 10v11"/>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <p style="font-weight: 600; font-size: 14px;">Bank Transfer</p>
                                <p style="font-size: 12px; color: var(--text-muted);">190 payments</p>
                            </div>
                            <span style="font-weight: 600; color: #00d4aa;">4%</span>
                        </div>
                    </div>

                    <!-- Recent Payments -->
                    <div class="card">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
                            <div>
                                <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Recent Payments</h3>
                                <p style="font-size: 12px; color: var(--text-muted);">5,798 Total</p>
                            </div>
                            <button class="btn btn-ghost btn-sm" onclick="openModal('allPayments')">View All</button>
                        </div>
                        <div class="table-wrapper">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Receipt</th>
                                        <th>Student</th>
                                        <th>Amount</th>
                                        <th>Mode</th>
                                    </tr>
                                </thead>
                                <tbody id="recentPaymentsTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Activity Log -->
                <div class="card" style="margin-top: 24px;">
                    <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">Recent Activity</h3>
                    <div id="activityLog"></div>
                </div>
            </div>

            <!-- Students Page -->
            <div id="page-students" class="page-content">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                    <div>
                        <h1 class="font-display" style="font-size: 22px; font-weight: 700;">Students Management</h1>
                        <p style="font-size: 13px; color: var(--text-muted);">Manage all student records</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="openModal('newAdmission')">Add New Student</button>
                        <button class="btn btn-ghost" onclick="exportData()">Export Data</button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="card" style="margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <input type="text" class="form-input" placeholder="Search by name, ID, class..." id="studentSearchInput" onkeyup="searchStudents()">
                        <select class="form-input" id="classFilterSelect" onchange="filterStudents()">
                            <option value="">All Classes</option>
                            <option value="Nursery">Nursery</option>
                            <option value="LKG">LKG</option>
                            <option value="UKG">UKG</option>
                            <option value="1st">1st</option>
                            <option value="2nd">2nd</option>
                            <option value="3rd">3rd</option>
                            <option value="4th">4th</option>
                            <option value="5th">5th</option>
                        </select>
                        <select class="form-input" id="statusFilterSelect" onchange="filterStudents()">
                            <option value="">All Status</option>
                            <option value="paid">Paid</option>
                            <option value="pending">Pending</option>
                            <option value="overdue">Overdue</option>
                        </select>
                    </div>
                </div>

                <!-- Students Table -->
                <div class="card">
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Student Name</th>
                                    <th>Class</th>
                                    <th>Parent</th>
                                    <th>Contact</th>
                                    <th>Fee Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Fee Collection Page -->
            <div id="page-fees" class="page-content">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;">
                    <div>
                        <h1 class="font-display" style="font-size: 22px; font-weight: 700;">Fee Collection</h1>
                        <p style="font-size: 13px; color: var(--text-muted);">This section contains features for Fees. All buttons are working!</p>
                    </div>
                    <button class="btn btn-primary" onclick="openModal('collectFee')">Collect New Fee</button>
                </div>

                <!-- Fee Stats -->
                <div class="stats-grid" style="margin-bottom: 24px;">
                    <div class="card">
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 6px;">Total Expected</p>
                        <p class="font-display" style="font-size: 22px; font-weight: 700;">₹22,98,40,000</p>
                    </div>
                    <div class="card">
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 6px;">Collected</p>
                        <p class="font-display" style="font-size: 22px; font-weight: 700; color: #10b981;">₹11,05,61,750</p>
                    </div>
                    <div class="card">
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 6px;">Pending</p>
                        <p class="font-display" style="font-size: 22px; font-weight: 700; color: #f59e0b;">₹11,92,78,250</p>
                    </div>
                    <div class="card">
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 6px;">Overdue</p>
                        <p class="font-display" style="font-size: 22px; font-weight: 700; color: #ef4444;">₹4,52,15,000</p>
                    </div>
                </div>

                <!-- Fee Records -->
                <div class="card">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 10px;">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Fee Records</h3>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-ghost btn-sm" onclick="filterFeeRecords('all')">All</button>
                            <button class="btn btn-ghost btn-sm" onclick="filterFeeRecords('paid')">Paid</button>
                            <button class="btn btn-ghost btn-sm" onclick="filterFeeRecords('pending')">Pending</button>
                            <button class="btn btn-ghost btn-sm" onclick="filterFeeRecords('overdue')">Overdue</button>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Receipt</th>
                                    <th>Student</th>
                                    <th>Class</th>
                                    <th>Amount</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="feeRecordsTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="page-reports" class="page-content">
                <div style="margin-bottom: 24px;">
                    <h1 class="font-display" style="font-size: 22px; font-weight: 700;">Reports & Analytics</h1>
                    <p style="font-size: 13px; color: var(--text-muted);">Generate comprehensive reports</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                    <div class="card" style="cursor: pointer;" onclick="generateReport('collection')">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(0, 212, 170, 0.15); display: flex; align-items: center; justify-content: center;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#00d4aa" stroke-width="2">
                                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                                </svg>
                            </div>
                            <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Collection Report</h3>
                        </div>
                        <p style="font-size: 13px; color: var(--text-muted);">Daily, weekly, monthly fee collection summary</p>
                    </div>

                    <div class="card" style="cursor: pointer;" onclick="generateReport('defaulter')">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(59, 130, 246, 0.15); display: flex; align-items: center; justify-content: center;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="12" y1="8" x2="12" y2="12"/>
                                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                                </svg>
                            </div>
                            <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Defaulter Report</h3>
                        </div>
                        <p style="font-size: 13px; color: var(--text-muted);">List of students with pending fees</p>
                    </div>

                    <div class="card" style="cursor: pointer;" onclick="generateReport('student')">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(168, 85, 247, 0.15); display: flex; align-items: center; justify-content: center;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#a855f7" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="9" cy="7" r="4"/>
                                </svg>
                            </div>
                            <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Student Report</h3>
                        </div>
                        <p style="font-size: 13px; color: var(--text-muted);">Class-wise student distribution</p>
                    </div>

                    <div class="card" style="cursor: pointer;" onclick="generateReport('payment')">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(249, 115, 22, 0.15); display: flex; align-items: center; justify-content: center;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2">
                                    <rect x="1" y="4" width="22" height="16" rx="2"/>
                                    <line x1="1" y1="10" x2="23" y2="10"/>
                                </svg>
                            </div>
                            <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Payment Methods</h3>
                        </div>
                        <p style="font-size: 13px; color: var(--text-muted);">Analysis of payment modes</p>
                    </div>

                    <div class="card" style="cursor: pointer;" onclick="generateReport('admission')">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(16, 185, 129, 0.15); display: flex; align-items: center; justify-content: center;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="8.5" cy="7" r="4"/>
                                    <line x1="20" y1="8" x2="20" y2="14"/>
                                    <line x1="23" y1="11" x2="17" y2="11"/>
                                </svg>
                            </div>
                            <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Admission Report</h3>
                        </div>
                        <p style="font-size: 13px; color: var(--text-muted);">New admissions and trends</p>
                    </div>

                    <div class="card" style="cursor: pointer;" onclick="generateReport('custom')">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: 12px; background: rgba(236, 72, 153, 0.15); display: flex; align-items: center; justify-content: center;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ec4899" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"/>
                                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33"/>
                                </svg>
                            </div>
                            <h3 class="font-display" style="font-size: 16px; font-weight: 600;">Custom Report</h3>
                        </div>
                        <p style="font-size: 13px; color: var(--text-muted);">Build your own custom report</p>
                    </div>
                </div>
            </div>

            <!-- QR Lookup Page -->
            <div id="page-qr" class="page-content">
                <div style="margin-bottom: 24px;">
                    <h1 class="font-display" style="font-size: 22px; font-weight: 700;">QR Lookup</h1>
                    <p style="font-size: 13px; color: var(--text-muted);">Scan student QR codes to view details</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Scan QR Code</h3>
                        <div style="border: 2px dashed var(--border); border-radius: 12px; padding: 32px; text-align: center;">
                            <div style="width: 100px; height: 100px; margin: 0 auto 16px; border-radius: 12px; background: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center;">
                                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="3" width="7" height="7"/>
                                    <rect x="14" y="3" width="7" height="7"/>
                                    <rect x="3" y="14" width="7" height="7"/>
                                    <rect x="14" y="14" width="7" height="7"/>
                                </svg>
                            </div>
                            <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">Click to start camera or upload QR</p>
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button class="btn btn-primary" onclick="startScan()">Start Scan</button>
                                <button class="btn btn-ghost" onclick="uploadQR()">Upload Image</button>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Manual Lookup</h3>
                        <div style="margin-bottom: 16px;">
                            <label class="form-label">Student ID</label>
                            <input type="text" class="form-input" placeholder="Enter ID (e.g., STU-2026-0001)" id="manualLookupId">
                        </div>
                        <button class="btn btn-primary" style="width: 100%;" onclick="manualLookup()">Lookup Student</button>
                        <div id="lookupResult" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>

            <!-- AI Assistant Page -->
            <div id="page-ai" class="page-content">
                <div style="margin-bottom: 24px;">
                    <h1 class="font-display" style="font-size: 22px; font-weight: 700;">AI Assistant</h1>
                    <p style="font-size: 13px; color: var(--text-muted);">Get intelligent help with school management</p>
                </div>

                <div class="card" style="height: 500px; display: flex; flex-direction: column;">
                    <div id="chatMessages" style="flex: 1; overflow-y: auto; padding: 16px; margin-bottom: 16px;">
                        <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                            <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <span style="font-weight: 600; font-size: 13px; color: #0a0f1a;">AI</span>
                            </div>
                            <div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 14px; max-width: 70%;">
                                <p style="font-size: 14px;">Hello! I'm your school management AI assistant. I can help you with:</p>
                                <ul style="margin-top: 10px; padding-left: 18px; font-size: 13px; color: var(--text-secondary);">
                                    <li>Fee collection queries</li>
                                    <li>Student information lookup</li>
                                    <li>Report generation</li>
                                    <li>Data analysis and insights</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div style="border-top: 1px solid var(--border); padding-top: 16px;">
                        <div style="display: flex; gap: 10px;">
                            <input type="text" class="form-input" placeholder="Ask me anything..." id="aiInputField" onkeypress="handleAIEnter(event)">
                            <button class="btn btn-primary" onclick="sendAIMessage()">Send</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="page-settings" class="page-content">
                <div style="margin-bottom: 24px;">
                    <h1 class="font-display" style="font-size: 22px; font-weight: 700;">Settings</h1>
                    <p style="font-size: 13px; color: var(--text-muted);">Configure your school management system</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px;">
                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">School Information</h3>
                        <div style="display: flex; flex-direction: column; gap: 14px;">
                            <div>
                                <label class="form-label">School Name</label>
                                <input type="text" class="form-input" value="Podar Learn School Niphad" id="settingSchoolName">
                            </div>
                            <div>
                                <label class="form-label">Academic Year</label>
                                <select class="form-input" id="settingYear">
                                    <option value="2026-27" selected>2026-27</option>
                                    <option value="2025-26">2025-26</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label">Address</label>
                                <textarea class="form-input" rows="2" id="settingAddress">Niphad, Maharashtra, India</textarea>
                            </div>
                            <button class="btn btn-primary" onclick="saveSettings()">Save Changes</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Fee Settings</h3>
                        <div style="display: flex; flex-direction: column; gap: 14px;">
                            <div>
                                <label class="form-label">Late Fee (Monthly)</label>
                                <input type="number" class="form-input" value="500" id="settingLateFee">
                            </div>
                            <div>
                                <label class="form-label">Fee Due Date</label>
                                <input type="date" class="form-input" value="2026-04-15" id="settingDueDate">
                            </div>
                            <div>
                                <label class="form-label">Currency</label>
                                <input type="text" class="form-input" value="₹" id="settingCurrency" maxlength="2">
                            </div>
                            <button class="btn btn-primary" onclick="saveSettings()">Save Changes</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Notifications</h3>
                        <div style="display: flex; flex-direction: column; gap: 14px;">
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border);">
                                <span style="font-size: 14px;">Email Notifications</span>
                                <label style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                    <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #00d4aa; border-radius: 12px; transition: 0.3s;"></span>
                                    <span style="position: absolute; content: ''; height: 18px; width: 18px; left: 23px; bottom: 3px; background: white; border-radius: 50%; transition: 0.3s;"></span>
                                </label>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border);">
                                <span style="font-size: 14px;">SMS Notifications</span>
                                <label style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                    <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #00d4aa; border-radius: 12px; transition: 0.3s;"></span>
                                    <span style="position: absolute; content: ''; height: 18px; width: 18px; left: 23px; bottom: 3px; background: white; border-radius: 50%; transition: 0.3s;"></span>
                                </label>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0;">
                                <span style="font-size: 14px;">Payment Reminders</span>
                                <label style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                    <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #00d4aa; border-radius: 12px; transition: 0.3s;"></span>
                                    <span style="position: absolute; content: ''; height: 18px; width: 18px; left: 23px; bottom: 3px; background: white; border-radius: 50%; transition: 0.3s;"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="font-display" style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Data Management</h3>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <button class="btn btn-ghost" onclick="backupData()" style="width: 100%;">Backup Data</button>
                            <button class="btn btn-ghost" onclick="restoreData()" style="width: 100%;">Restore Data</button>
                            <button class="btn btn-ghost" onclick="clearData()" style="width: 100%; color: #ef4444; border-color: rgba(239, 68, 68, 0.3);">Clear All Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- MODALS -->
    <!-- New Admission Modal -->
    <div class="modal-overlay" id="modal-newAdmission">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title font-display">Add New Student</h2>
                <button class="modal-close" onclick="closeModal('newAdmission')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <form onsubmit="submitNewStudent(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                    <div>
                        <label class="form-label">First Name</label>
                        <input type="text" class="form-input" required id="newStudentFName">
                    </div>
                    <div>
                        <label class="form-label">Last Name</label>
                        <input type="text" class="form-input" required id="newStudentLName">
                    </div>
                    <div>
                        <label class="form-label">Class</label>
                        <select class="form-input" required id="newStudentClass">
                            <option value="">Select</option>
                            <option value="Nursery">Nursery</option>
                            <option value="LKG">LKG</option>
                            <option value="UKG">UKG</option>
                            <option value="1st">1st</option>
                            <option value="2nd">2nd</option>
                            <option value="3rd">3rd</option>
                            <option value="4th">4th</option>
                            <option value="5th">5th</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">Section</label>
                        <select class="form-input" required id="newStudentSection">
                            <option value="">Select</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">Parent Name</label>
                        <input type="text" class="form-input" required id="newStudentParent">
                    </div>
                    <div>
                        <label class="form-label">Contact</label>
                        <input type="tel" class="form-input" required id="newStudentContact">
                    </div>
                    <div>
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="newStudentEmail">
                    </div>
                    <div>
                        <label class="form-label">DOB</label>
                        <input type="date" class="form-input" required id="newStudentDOB">
                    </div>
                </div>
                <div style="margin-top: 14px;">
                    <label class="form-label">Address</label>
                    <textarea class="form-input" rows="2" id="newStudentAddress"></textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('newAdmission')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Student</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Collect Fee Modal -->
    <div class="modal-overlay" id="modal-collectFee">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title font-display">Collect Fee</h2>
                <button class="modal-close" onclick="closeModal('collectFee')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <form onsubmit="submitFeeCollection(event)">
                <div style="display: flex; flex-direction: column; gap: 14px;">
                    <div>
                        <label class="form-label">Search Student</label>
                        <input type="text" class="form-input" placeholder="Enter name or ID..." id="feeSearchStudent" onkeyup="searchFeeStudent()">
                        <div id="feeSearchResults" style="margin-top: 8px;"></div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                        <div>
                            <label class="form-label">Student Name</label>
                            <input type="text" class="form-input" id="feeStudentName" readonly>
                        </div>
                        <div>
                            <label class="form-label">Class</label>
                            <input type="text" class="form-input" id="feeStudentClass" readonly>
                        </div>
                    </div>
                    <div>
                        <label class="form-label">Fee Type</label>
                        <select class="form-input" required id="feeTypeSelect">
                            <option value="">Select</option>
                            <option value="Tuition Fee">Tuition Fee</option>
                            <option value="Admission Fee">Admission Fee</option>
                            <option value="Exam Fee">Exam Fee</option>
                            <option value="Transport Fee">Transport Fee</option>
                            <option value="Library Fee">Library Fee</option>
                            <option value="Lab Fee">Lab Fee</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                        <div>
                            <label class="form-label">Amount</label>
                            <input type="number" class="form-input" required id="feeAmountInput" placeholder="Enter amount">
                        </div>
                        <div>
                            <label class="form-label">Payment Mode</label>
                            <select class="form-input" required id="feeModeSelect">
                                <option value="">Select</option>
                                <option value="UPI">UPI</option>
                                <option value="Cash">Cash</option>
                                <option value="Card">Card</option>
                                <option value="Cheque">Cheque</option>
                                <option value="Bank Transfer">Bank Transfer</option>
                            </select>
                        </div>
                    </div>
                    <div id="chequeFields" style="display: none;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                            <div>
                                <label class="form-label">Cheque Number</label>
                                <input type="text" class="form-input" id="chequeNum">
                            </div>
                            <div>
                                <label class="form-label">Bank Name</label>
                                <input type="text" class="form-input" id="chequeBank">
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="form-label">Remarks</label>
                        <textarea class="form-input" rows="2" id="feeRemarks" placeholder="Any notes..."></textarea>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('collectFee')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Collect & Receipt</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div class="modal-overlay" id="modal-receipt">
        <div class="modal print-area" style="max-width: 420px;">
            <div id="receiptContent" style="text-align: center;">
                <div style="width: 56px; height: 56px; margin: 0 auto 12px; border-radius: 14px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center;">
                    <span class="font-display" style="font-size: 22px; font-weight: 700; color: #0a0f1a;">P</span>
                </div>
                <h2 class="font-display" style="font-size: 18px; font-weight: 700; margin-bottom: 4px;">Podar Learn School Niphad</h2>
                <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 20px;">Fee Receipt</p>
                
                <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 16px; text-align: left; margin-bottom: 16px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px;">
                        <p style="color: var(--text-muted);">Receipt No:</p>
                        <p style="font-weight: 600;" id="rcptNo">-</p>
                        <p style="color: var(--text-muted);">Date:</p>
                        <p style="font-weight: 600;" id="rcptDate">-</p>
                        <p style="color: var(--text-muted);">Student:</p>
                        <p style="font-weight: 600;" id="rcptStudent">-</p>
                        <p style="color: var(--text-muted);">Class:</p>
                        <p style="font-weight: 600;" id="rcptClass">-</p>
                        <p style="color: var(--text-muted);">Fee Type:</p>
                        <p style="font-weight: 600;" id="rcptFeeType">-</p>
                        <p style="color: var(--text-muted);">Amount:</p>
                        <p style="font-weight: 700; color: #00d4aa; font-size: 16px;" id="rcptAmount">-</p>
                        <p style="color: var(--text-muted);">Mode:</p>
                        <p style="font-weight: 600;" id="rcptMode">-</p>
                    </div>
                </div>
                
                <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">Thank you for your payment!</p>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-ghost" style="flex: 1;" onclick="closeModal('receipt')">Close</button>
                    <button class="btn btn-primary" style="flex: 1;" onclick="printReceipt()">Print</button>
                </div>
            </div>
        </div>
    </div>

    <!-- All Payments Modal -->
    <div class="modal-overlay" id="modal-allPayments">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title font-display">All Payments</h2>
                <button class="modal-close" onclick="closeModal('allPayments')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="table-wrapper" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Receipt</th>
                            <th>Student</th>
                            <th>Amount</th>
                            <th>Mode</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="allPaymentsTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Student Details Modal -->
    <div class="modal-overlay" id="modal-studentDetails">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title font-display">Student Details</h2>
                <button class="modal-close" onclick="closeModal('studentDetails')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div id="studentDetailsContent"></div>
        </div>
    </div>

    <script>
        // =============================================
        // DATA STORE - LIVE DATA
        // =============================================
        const studentsDB = [
            { id: 'STU-2026-0001', firstName: 'Aarav', lastName: 'Sharma', class: '5th', section: 'A', parent: 'Rajesh Sharma', contact: '9876543210', feeStatus: 'paid' },
            { id: 'STU-2026-0002', firstName: 'Ananya', lastName: 'Patel', class: '4th', section: 'B', parent: 'Vikram Patel', contact: '9876543211', feeStatus: 'pending' },
            { id: 'STU-2026-0003', firstName: 'Arjun', lastName: 'Kumar', class: '3rd', section: 'A', parent: 'Suresh Kumar', contact: '9876543212', feeStatus: 'paid' },
            { id: 'STU-2026-0004', firstName: 'Diya', lastName: 'Singh', class: '2nd', section: 'C', parent: 'Mohan Singh', contact: '9876543213', feeStatus: 'overdue' },
            { id: 'STU-2026-0005', firstName: 'Ishaan', lastName: 'Verma', class: '1st', section: 'A', parent: 'Amit Verma', contact: '9876543214', feeStatus: 'paid' },
            { id: 'STU-2026-0006', firstName: 'Kavya', lastName: 'Gupta', class: 'UKG', section: 'B', parent: 'Rahul Gupta', contact: '9876543215', feeStatus: 'pending' },
            { id: 'STU-2026-0007', firstName: 'Vihaan', lastName: 'Joshi', class: 'LKG', section: 'A', parent: 'Sanjay Joshi', contact: '9876543216', feeStatus: 'paid' },
            { id: 'STU-2026-0008', firstName: 'Myra', lastName: 'Yadav', class: 'Nursery', section: 'C', parent: 'Krishna Yadav', contact: '9876543217', feeStatus: 'paid' },
            { id: 'STU-2026-0009', firstName: 'Ramesh', lastName: 'Patel', class: '7th', section: 'E', parent: 'Magan Patel', contact: '9876543218', feeStatus: 'paid' },
            { id: 'STU-2026-0010', firstName: 'Nikhil', lastName: 'Mahajan', class: '6th', section: 'D', parent: 'Dilip Mahajan', contact: '9876543219', feeStatus: 'paid' },
        ];

        const paymentsDB = [
            { receipt: 'REC-2026-026523', student: 'Ramesh Patel', class: '7th-E', amount: 13000, mode: 'Cheque', date: '25 Feb 2026' },
            { receipt: 'REC-2026-026057', student: 'Nikhil Mahajan', class: '6th-D', amount: 12000, mode: 'Bank Transfer', date: '25 Feb 2026' },
            { receipt: 'REC-2026-026015', student: 'Geeta Chauhan', class: '6th-E', amount: 12000, mode: 'Cheque', date: '24 Feb 2026' },
            { receipt: 'REC-2026-025928', student: 'Ashok Malik', class: '6th-A', amount: 12000, mode: 'Card', date: '24 Feb 2026' },
            { receipt: 'REC-2026-025548', student: 'Padma Kadam', class: '5th-D', amount: 24000, mode: 'UPI', date: '23 Feb 2026' },
            { receipt: 'REC-2026-025421', student: 'Suresh Patil', class: '4th-B', amount: 11000, mode: 'Cash', date: '23 Feb 2026' },
            { receipt: 'REC-2026-025312', student: 'Meena Devi', class: '3rd-C', amount: 10500, mode: 'UPI', date: '22 Feb 2026' },
        ];

        const activityDB = [
            { title: 'Fee collection for Academic Year 2026-27 started', time: '2026-04-01 09:00 AM' },
            { title: '5,000 students enrolled for new academic session', time: '2026-04-01 10:00 AM' },
            { title: 'New admissions open for Nursery to 12th', time: '2026-03-15 11:00 AM' },
            { title: 'Cloud backup system activated', time: '2026-04-02 09:00 AM' },
            { title: 'Fee structure updated for new academic year', time: '2026-03-20 02:00 PM' },
        ];

        let receiptCounter = 27000;

        // =============================================
        // INITIALIZATION
        // =============================================
        document.addEventListener('DOMContentLoaded', function() {
            updateDateGreeting();
            renderRecentPayments();
            renderActivityLog();
            renderStudentsTable();
            renderFeeRecords();
            initCharts();
            
            // Cheque fields toggle
            document.getElementById('feeModeSelect').addEventListener('change', function() {
                document.getElementById('chequeFields').style.display = this.value === 'Cheque' ? 'block' : 'none';
            });
        });

        // =============================================
        // DATE & GREETING
        // =============================================
        function updateDateGreeting() {
            const now = new Date();
            const options = { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-IN', options);
            
            const hour = now.getHours();
            let greeting = 'Good Morning';
            if (hour >= 12 && hour < 17) greeting = 'Good Afternoon';
            else if (hour >= 17) greeting = 'Good Evening';
            
            document.getElementById('greeting').textContent = greeting;
        }

        // =============================================
        // SIDEBAR & NAVIGATION
        // =============================================
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function switchPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById('page-' + pageName).classList.add('active');
            
            // Update sidebar active state
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.page === pageName) {
                    item.classList.add('active');
                }
            });
            
            // Close mobile sidebar
            document.getElementById('sidebar').classList.remove('open');
        }

        // =============================================
        // MODAL FUNCTIONS
        // =============================================
        function openModal(modalName) {
            document.getElementById('modal-' + modalName).classList.add('active');
        }

        function closeModal(modalName) {
            document.getElementById('modal-' + modalName).classList.remove('active');
        }

        // Close modal on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // =============================================
        // RENDER FUNCTIONS
        // =============================================
        function renderRecentPayments() {
            const tbody = document.getElementById('recentPaymentsTable');
            tbody.innerHTML = paymentsDB.slice(0, 5).map(p => `
                <tr>
                    <td style="font-family: monospace; font-size: 12px;">${p.receipt}</td>
                    <td>
                        <p style="font-weight: 500;">${p.student}</p>
                        <p style="font-size: 11px; color: var(--text-muted);">${p.class}</p>
                    </td>
                    <td style="font-weight: 600; color: #00d4aa;">₹${p.amount.toLocaleString('en-IN')}</td>
                    <td><span class="badge ${getModeBadge(p.mode)}">${p.mode}</span></td>
                </tr>
            `).join('');
        }

        function renderAllPayments() {
            const tbody = document.getElementById('allPaymentsTable');
            tbody.innerHTML = paymentsDB.map(p => `
                <tr>
                    <td style="font-family: monospace; font-size: 12px;">${p.receipt}</td>
                    <td>
                        <p style="font-weight: 500;">${p.student}</p>
                        <p style="font-size: 11px; color: var(--text-muted);">${p.class}</p>
                    </td>
                    <td style="font-weight: 600; color: #00d4aa;">₹${p.amount.toLocaleString('en-IN')}</td>
                    <td><span class="badge ${getModeBadge(p.mode)}">${p.mode}</span></td>
                    <td style="color: var(--text-muted); font-size: 12px;">${p.date}</td>
                </tr>
            `).join('');
            openModal('allPayments');
        }

        function renderActivityLog() {
            const container = document.getElementById('activityLog');
            container.innerHTML = activityDB.map(a => `
                <div class="activity-item">
                    <div class="activity-dot"></div>
                    <div>
                        <p style="font-weight: 500; font-size: 14px;">${a.title}</p>
                        <p style="font-size: 12px; color: var(--text-muted);">${a.time}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderStudentsTable() {
            const tbody = document.getElementById('studentsTableBody');
            tbody.innerHTML = studentsDB.map(s => `
                <tr>
                    <td style="font-family: monospace; font-size: 12px;">${s.id}</td>
                    <td style="font-weight: 500;">${s.firstName} ${s.lastName}</td>
                    <td>${s.class}-${s.section}</td>
                    <td>${s.parent}</td>
                    <td>${s.contact}</td>
                    <td><span class="badge ${getStatusBadge(s.feeStatus)}">${s.feeStatus}</span></td>
                    <td>
                        <div style="display: flex; gap: 6px;">
                            <button class="btn btn-ghost btn-sm" onclick="viewStudent('${s.id}')">View</button>
                            <button class="btn btn-ghost btn-sm" onclick="editStudent('${s.id}')">Edit</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function renderFeeRecords() {
            const tbody = document.getElementById('feeRecordsTable');
            const records = [
                { receipt: 'REC-2026-001', student: 'Aarav Sharma', class: '5th-A', amount: 24000, date: '20 Feb 2026', status: 'paid' },
                { receipt: 'REC-2026-002', student: 'Ananya Patel', class: '4th-B', amount: 22000, date: '20 Feb 2026', status: 'pending' },
                { receipt: 'REC-2026-003', student: 'Arjun Kumar', class: '3rd-A', amount: 21000, date: '19 Feb 2026', status: 'paid' },
                { receipt: 'REC-2026-004', student: 'Diya Singh', class: '2nd-C', amount: 20000, date: '15 Feb 2026', status: 'overdue' },
            ];
            
            tbody.innerHTML = records.map(r => `
                <tr>
                    <td style="font-family: monospace; font-size: 12px;">${r.receipt}</td>
                    <td style="font-weight: 500;">${r.student}</td>
                    <td>${r.class}</td>
                    <td style="font-weight: 600;">₹${r.amount.toLocaleString('en-IN')}</td>
                    <td style="color: var(--text-muted); font-size: 12px;">${r.date}</td>
                    <td><span class="badge ${getStatusBadge(r.status)}">${r.status}</span></td>
                    <td><button class="btn btn-ghost btn-sm" onclick="viewReceiptById('${r.receipt}')">View</button></td>
                </tr>
            `).join('');
        }

        // =============================================
        // CHARTS
        // =============================================
        function initCharts() {
            // Monthly Collection Chart
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            new Chart(monthlyCtx, {
                type: 'bar',
                data: {
                    labels: ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar'],
                    datasets: [{
                        label: 'Collection',
                        data: [85, 72, 61, 58, 92, 88, 75, 69, 110, 95, 110, 0],
                        backgroundColor: (context) => {
                            const ctx = context.chart.ctx;
                            const gradient = ctx.createLinearGradient(0, 0, 0, 250);
                            gradient.addColorStop(0, 'rgba(0, 212, 170, 0.8)');
                            gradient.addColorStop(1, 'rgba(0, 212, 170, 0.1)');
                            return gradient;
                        },
                        borderColor: '#00d4aa',
                        borderWidth: 2,
                        borderRadius: 6,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1a2332',
                            callbacks: {
                                label: (ctx) => '₹' + ctx.raw + ' Lakh'
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(45, 55, 72, 0.5)' },
                            ticks: { color: '#94a3b8' }
                        },
                        y: {
                            grid: { color: 'rgba(45, 55, 72, 0.5)' },
                            ticks: { color: '#94a3b8', callback: (v) => '₹' + v + 'L' }
                        }
                    }
                }
            });

            // Class Distribution Chart
            const classCtx = document.getElementById('classChart').getContext('2d');
            new Chart(classCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Nursery', 'LKG', 'UKG', '1st', '2nd', '3rd', '4th', '5th'],
                    datasets: [{
                        data: [332, 328, 326, 333, 327, 322, 330, 333],
                        backgroundColor: [
                            '#00d4aa', '#3b82f6', '#ff6b35', '#a855f7',
                            '#f59e0b', '#ec4899', '#14b8a6', '#6366f1'
                        ],
                        borderColor: '#1a2332',
                        borderWidth: 3,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { color: '#94a3b8', padding: 12, usePointStyle: true }
                        }
                    }
                }
            });
        }

        // =============================================
        // BADGE HELPERS
        // =============================================
        function getModeBadge(mode) {
            const badges = {
                'UPI': 'badge-purple',
                'Cash': 'badge-success',
                'Card': 'badge-blue',
                'Cheque': 'badge-orange',
                'Bank Transfer': 'badge-cyan'
            };
            return badges[mode] || 'badge-success';
        }

        function getStatusBadge(status) {
            const badges = {
                'paid': 'badge-success',
                'pending': 'badge-warning',
                'overdue': 'badge-danger'
            };
            return badges[status] || 'badge-success';
        }

        // =============================================
        // STUDENT FUNCTIONS
        // =============================================
        function submitNewStudent(e) {
            e.preventDefault();
            
            const newStudent = {
                id: 'STU-2026-' + String(studentsDB.length + 1).padStart(4, '0'),
                firstName: document.getElementById('newStudentFName').value,
                lastName: document.getElementById('newStudentLName').value,
                class: document.getElementById('newStudentClass').value,
                section: document.getElementById('newStudentSection').value,
                parent: document.getElementById('newStudentParent').value,
                contact: document.getElementById('newStudentContact').value,
                feeStatus: 'pending'
            };
            
            studentsDB.push(newStudent);
            renderStudentsTable();
            closeModal('newAdmission');
            showNotification('Student added successfully!', 'success');
            e.target.reset();
        }

        function viewStudent(studentId) {
            const student = studentsDB.find(s => s.id === studentId);
            if (!student) return;
            
            const content = document.getElementById('studentDetailsContent');
            content.innerHTML = `
                <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 20px;">
                    <div style="width: 56px; height: 56px; border-radius: 14px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 18px; font-weight: 700; color: #0a0f1a;">${student.firstName.charAt(0)}${student.lastName.charAt(0)}</span>
                    </div>
                    <div>
                        <h3 style="font-size: 18px; font-weight: 700;">${student.firstName} ${student.lastName}</h3>
                        <p style="font-size: 12px; color: var(--text-muted);">${student.id}</p>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
                    <div class="card" style="padding: 14px;">
                        <p style="font-size: 12px; color: var(--text-muted);">Class</p>
                        <p style="font-weight: 600;">${student.class}-${student.section}</p>
                    </div>
                    <div class="card" style="padding: 14px;">
                        <p style="font-size: 12px; color: var(--text-muted);">Fee Status</p>
                        <p><span class="badge ${getStatusBadge(student.feeStatus)}">${student.feeStatus}</span></p>
                    </div>
                    <div class="card" style="padding: 14px;">
                        <p style="font-size: 12px; color: var(--text-muted);">Parent</p>
                        <p style="font-weight: 600;">${student.parent}</p>
                    </div>
                    <div class="card" style="padding: 14px;">
                        <p style="font-size: 12px; color: var(--text-muted);">Contact</p>
                        <p style="font-weight: 600;">${student.contact}</p>
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" style="flex: 1;" onclick="collectFeeFor('${student.id}')">Collect Fee</button>
                    <button class="btn btn-ghost" style="flex: 1;" onclick="editStudent('${student.id}')">Edit</button>
                </div>
            `;
            openModal('studentDetails');
        }

        function editStudent(studentId) {
            showNotification('Edit mode for: ' + studentId, 'info');
        }

        function collectFeeFor(studentId) {
            const student = studentsDB.find(s => s.id === studentId);
            if (student) {
                document.getElementById('feeStudentName').value = `${student.firstName} ${student.lastName}`;
                document.getElementById('feeStudentClass').value = `${student.class}-${student.section}`;
                document.getElementById('feeSearchStudent').value = student.id;
            }
            closeModal('studentDetails');
            openModal('collectFee');
        }

        function searchStudents() {
            const query = document.getElementById('studentSearchInput').value.toLowerCase();
            const filtered = studentsDB.filter(s => 
                s.firstName.toLowerCase().includes(query) ||
                s.lastName.toLowerCase().includes(query) ||
                s.id.toLowerCase().includes(query) ||
                s.class.toLowerCase().includes(query)
            );
            renderFilteredStudents(filtered);
        }

        function filterStudents() {
            let filtered = [...studentsDB];
            const classFilter = document.getElementById('classFilterSelect').value;
            const statusFilter = document.getElementById('statusFilterSelect').value;
            
            if (classFilter) {
                filtered = filtered.filter(s => s.class === classFilter);
            }
            if (statusFilter) {
                filtered = filtered.filter(s => s.feeStatus === statusFilter);
            }
            
            renderFilteredStudents(filtered);
        }

        function renderFilteredStudents(students) {
            const tbody = document.getElementById('studentsTableBody');
            tbody.innerHTML = students.map(s => `
                <tr>
                    <td style="font-family: monospace; font-size: 12px;">${s.id}</td>
                    <td style="font-weight: 500;">${s.firstName} ${s.lastName}</td>
                    <td>${s.class}-${s.section}</td>
                    <td>${s.parent}</td>
                    <td>${s.contact}</td>
                    <td><span class="badge ${getStatusBadge(s.feeStatus)}">${s.feeStatus}</span></td>
                    <td>
                        <div style="display: flex; gap: 6px;">
                            <button class="btn btn-ghost btn-sm" onclick="viewStudent('${s.id}')">View</button>
                            <button class="btn btn-ghost btn-sm" onclick="editStudent('${s.id}')">Edit</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =============================================
        // FEE FUNCTIONS
        // =============================================
        function searchFeeStudent() {
            const query = document.getElementById('feeSearchStudent').value.toLowerCase();
            if (query.length < 2) {
                document.getElementById('feeSearchResults').innerHTML = '';
                return;
            }
            
            const results = studentsDB.filter(s => 
                s.firstName.toLowerCase().includes(query) ||
                s.lastName.toLowerCase().includes(query) ||
                s.id.toLowerCase().includes(query)
            );
            
            if (results.length > 0) {
                document.getElementById('feeSearchResults').innerHTML = results.slice(0, 3).map(s => `
                    <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px; margin-bottom: 6px; cursor: pointer;" onclick="selectFeeStudent('${s.id}')">
                        <p style="font-weight: 500;">${s.firstName} ${s.lastName}</p>
                        <p style="font-size: 11px; color: var(--text-muted);">${s.id} | ${s.class}-${s.section}</p>
                    </div>
                `).join('');
            }
        }

        function selectFeeStudent(studentId) {
            const student = studentsDB.find(s => s.id === studentId);
            if (student) {
                document.getElementById('feeStudentName').value = `${student.firstName} ${student.lastName}`;
                document.getElementById('feeStudentClass').value = `${student.class}-${student.section}`;
                document.getElementById('feeSearchResults').innerHTML = '';
                document.getElementById('feeSearchStudent').value = '';
            }
        }

        function submitFeeCollection(e) {
            e.preventDefault();
            
            const receiptNo = 'REC-2026-' + String(receiptCounter++).padStart(6, '0');
            const now = new Date();
            
            // Generate receipt
            document.getElementById('rcptNo').textContent = receiptNo;
            document.getElementById('rcptDate').textContent = now.toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' });
            document.getElementById('rcptStudent').textContent = document.getElementById('feeStudentName').value || 'Test Student';
            document.getElementById('rcptClass').textContent = document.getElementById('feeStudentClass').value || '-';
            document.getElementById('rcptFeeType').textContent = document.getElementById('feeTypeSelect').value;
            document.getElementById('rcptAmount').textContent = '₹' + parseInt(document.getElementById('feeAmountInput').value).toLocaleString('en-IN');
            document.getElementById('rcptMode').textContent = document.getElementById('feeModeSelect').value;
            
            // Add to payments
            paymentsDB.unshift({
                receipt: receiptNo,
                student: document.getElementById('feeStudentName').value || 'Test Student',
                class: document.getElementById('feeStudentClass').value || '-',
                amount: parseInt(document.getElementById('feeAmountInput').value),
                mode: document.getElementById('feeModeSelect').value,
                date: now.toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })
            });
            
            renderRecentPayments();
            
            closeModal('collectFee');
            openModal('receipt');
            showNotification('Fee collected successfully!', 'success');
        }

        function filterFeeRecords(filter) {
            showNotification('Showing ' + filter + ' records', 'info');
        }

        function viewReceiptById(receiptNo) {
            const payment = paymentsDB.find(p => p.receipt === receiptNo);
            if (payment) {
                document.getElementById('rcptNo').textContent = payment.receipt;
                document.getElementById('rcptDate').textContent = payment.date;
                document.getElementById('rcptStudent').textContent = payment.student;
                document.getElementById('rcptClass').textContent = payment.class;
                document.getElementById('rcptFeeType').textContent = 'Tuition Fee';
                document.getElementById('rcptAmount').textContent = '₹' + payment.amount.toLocaleString('en-IN');
                document.getElementById('rcptMode').textContent = payment.mode;
                openModal('receipt');
            }
        }

        function printReceipt() {
            window.print();
        }

        // =============================================
        // QR LOOKUP
        // =============================================
        function startScan() {
            showNotification('Scanning...', 'info');
            setTimeout(() => {
                const randomStudent = studentsDB[Math.floor(Math.random() * studentsDB.length)];
                showLookupResult(randomStudent);
                showNotification('QR scanned successfully!', 'success');
            }, 1500);
        }

        function uploadQR() {
            showNotification('Upload feature - select QR image', 'info');
        }

        function manualLookup() {
            const studentId = document.getElementById('manualLookupId').value;
            if (!studentId) {
                showNotification('Please enter a student ID', 'error');
                return;
            }
            
            const student = studentsDB.find(s => s.id.toLowerCase() === studentId.toLowerCase());
            if (student) {
                showLookupResult(student);
            } else {
                document.getElementById('lookupResult').innerHTML = `
                    <p style="color: #ef4444; font-size: 14px;">Student not found</p>
                `;
            }
        }

        function showLookupResult(student) {
            document.getElementById('lookupResult').innerHTML = `
                <div style="border: 1px solid var(--border); border-radius: 12px; padding: 16px;">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div style="width: 44px; height: 44px; border-radius: 10px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center;">
                            <span style="font-weight: 600; color: #0a0f1a;">${student.firstName.charAt(0)}${student.lastName.charAt(0)}</span>
                        </div>
                        <div>
                            <p style="font-weight: 600;">${student.firstName} ${student.lastName}</p>
                            <p style="font-size: 12px; color: var(--text-muted);">${student.id}</p>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 13px; margin-bottom: 12px;">
                        <p style="color: var(--text-muted);">Class:</p>
                        <p>${student.class}-${student.section}</p>
                        <p style="color: var(--text-muted);">Parent:</p>
                        <p>${student.parent}</p>
                        <p style="color: var(--text-muted);">Contact:</p>
                        <p>${student.contact}</p>
                        <p style="color: var(--text-muted);">Fee Status:</p>
                        <p><span class="badge ${getStatusBadge(student.feeStatus)}">${student.feeStatus}</span></p>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-primary btn-sm" style="flex: 1;" onclick="collectFeeFor('${student.id}')">Collect Fee</button>
                        <button class="btn btn-ghost btn-sm" style="flex: 1;" onclick="viewStudent('${student.id}')">Details</button>
                    </div>
                </div>
            `;
        }

        // =============================================
        // AI ASSISTANT
        // =============================================
        function sendAIMessage() {
            const input = document.getElementById('aiInputField');
            const message = input.value.trim();
            if (!message) return;
            
            const chatContainer = document.getElementById('chatMessages');
            
            // User message
            chatContainer.innerHTML += `
                <div style="display: flex; gap: 12px; margin-bottom: 16px; justify-content: flex-end;">
                    <div style="background: rgba(0, 212, 170, 0.15); border-radius: 12px; padding: 14px; max-width: 70%;">
                        <p style="font-size: 14px;">${message}</p>
                    </div>
                    <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #ff6b35, #f97316); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <span style="font-weight: 600; font-size: 13px;">AC</span>
                    </div>
                </div>
            `;
            
            input.value = '';
            
            // AI response
            setTimeout(() => {
                let response = '';
                const lowerMsg = message.toLowerCase();
                
                if (lowerMsg.includes('fee') || lowerMsg.includes('collection')) {
                    response = 'Current Fee Status:\n• Total Expected: ₹22.98 Cr\n• Collected: ₹11.05 Cr (48.1%)\n• Pending: ₹11.92 Cr\n\nWould you like a detailed report?';
                } else if (lowerMsg.includes('student') || lowerMsg.includes('admission')) {
                    response = 'Student Statistics:\n• Total: 4,817 students\n• Nursery: 332\n• LKG: 328\n• UKG: 326\n\nNew admissions are open!';
                } else if (lowerMsg.includes('defaulter') || lowerMsg.includes('pending')) {
                    response = '3,106 students have pending fees totaling ₹11.92 Cr.\n\nTop defaulters by class:\n1. 5th - 412 students\n2. 4th - 398 students';
                } else {
                    response = 'I can help you with:\n• Fee collection queries\n• Student information\n• Report generation\n• Data analysis\n\nWhat would you like to know?';
                }
                
                chatContainer.innerHTML += `
                    <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                        <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #00d4aa, #00b894); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <span style="font-weight: 600; font-size: 13px; color: #0a0f1a;">AI</span>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 14px; max-width: 70%;">
                            <p style="font-size: 14px; white-space: pre-line;">${response}</p>
                        </div>
                    </div>
                `;
                
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 800);
        }

        function handleAIEnter(e) {
            if (e.key === 'Enter') sendAIMessage();
        }

        // =============================================
        // REPORTS
        // =============================================
        function generateReport(type) {
            showNotification('Generating ' + type + ' report...', 'info');
            setTimeout(() => {
                const messages = {
                    'collection': 'Collection Report: ₹11.05 Cr collected (48.1%)',
                    'defaulter': 'Defaulter Report: 3,106 students with pending fees',
                    'student': 'Student Report: 4,817 active students',
                    'payment': 'Payment Report: UPI 49%, Cash 26%, Card 15%',
                    'admission': 'Admission Report: 500 new this session',
                    'custom': 'Custom report builder opened'
                };
                showNotification(messages[type] || 'Report generated', 'success');
            }, 1000);
        }

        // =============================================
        // SETTINGS
        // =============================================
        function saveSettings() {
            showNotification('Settings saved!', 'success');
        }

        function backupData() {
            showNotification('Creating backup...', 'info');
            setTimeout(() => showNotification('Backup completed!', 'success'), 1500);
        }

        function restoreData() {
            showNotification('Select backup file to restore', 'info');
        }

        function clearData() {
            if (confirm('Clear all data? This cannot be undone.')) {
                showNotification('All data cleared', 'warning');
            }
        }

        function exportData() {
            showNotification('Exporting to Excel...', 'info');
            setTimeout(() => showNotification('Data exported!', 'success'), 1000);
        }

        // =============================================
        // NOTIFICATIONS
        // =============================================
        function showNotification(message, type) {
            const colors = {
                success: '#10b981',
                error: '#ef4444',
                warning: '#f59e0b',
                info: '#3b82f6'
            };
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.background = colors[type] || colors.info;
            notification.innerHTML = `
                <span>${message}</span>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; color: white; cursor: pointer; margin-left: 10px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3500);
        }
    </script>
</body>
</html>
